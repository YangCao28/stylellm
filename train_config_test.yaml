# ========================================
# 单卡测试配置 - Qwen3-4B
# ========================================

model:
  model_name_or_path: "Qwen/Qwen3-4B"  # 4B模型，快速测试
  
  use_lora: true
  lora_r: 8              # 降低rank加快测试
  lora_alpha: 16
  lora_dropout: 0.05
  lora_target_modules:
    - "q_proj"
    - "v_proj"
    - "k_proj"
    - "o_proj"

data:
  data_dir: "./data"
  processed_data_file: "./data/processed_wuxia.jsonl"
  max_length: 512        # 降低长度加快测试
  min_length: 50
  stride: 256
  val_ratio: 0.1

training:
  output_dir: "./output/test_run"
  
  # 单卡测试配置（降低显存占用）
  num_train_epochs: 1              # 只跑1个epoch测试
  per_device_train_batch_size: 1   # 降低到1
  per_device_eval_batch_size: 2
  gradient_accumulation_steps: 1   # 暂时改为1，以便立即看到进度条移动
  
  learning_rate: 5.0e-5
  weight_decay: 0.01
  warmup_steps: 50
  
  logging_steps: 1                 # 每一步都打印日志，确认是否卡死
  save_steps: 100
  eval_steps: 100
  save_total_limit: 2
  
  fp16: true
  bf16: false
  gradient_checkpointing: true     # 重新开启节省显存
  seed: 42
